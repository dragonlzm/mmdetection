from matplotlib.pyplot import annotate
import mmcv
import warnings
import pycocotools
from pycocotools.coco import COCO as _COCO
from pycocotools.cocoeval import COCOeval as _COCOeval
import numpy as np
from collections import OrderedDict


class COCO(_COCO):
    def __init__(self, annotation_file=None):
        if getattr(pycocotools, '__version__', '0') >= '12.0.2':
            warnings.warn(
                'mmpycocotools is deprecated. Please install official pycocotools by "pip install pycocotools"',  # noqa: E501
                UserWarning)
        super().__init__(annotation_file=annotation_file)
        self.img_ann_map = self.imgToAnns
        self.cat_img_map = self.catToImgs
    def get_ann_ids(self, img_ids=[], cat_ids=[], area_rng=[], iscrowd=None):
        return self.getAnnIds(img_ids, cat_ids, area_rng, iscrowd)
    def get_cat_ids(self, cat_names=[], sup_names=[], cat_ids=[]):
        return self.getCatIds(cat_names, sup_names, cat_ids)
    def get_img_ids(self, img_ids=[], cat_ids=[]):
        return self.getImgIds(img_ids, cat_ids)
    def load_anns(self, ids):
        return self.loadAnns(ids)
    def load_cats(self, ids):
        return self.loadCats(ids)
    def load_imgs(self, ids):
        return self.loadImgs(ids)

# just for the ease of import
COCOeval = _COCOeval

CLASSES_65 = ('person', 'bicycle', 'car', 'motorcycle', 'airplane', 'bus', 
 'train', 'truck', 'boat', 'bench', 'bird', 'cat', 'dog', 
 'horse', 'sheep', 'cow', 'elephant', 'bear', 'zebra', 'giraffe', 
 'backpack', 'umbrella', 'handbag', 'tie', 'suitcase', 'frisbee', 
 'skis', 'snowboard', 'kite', 'skateboard', 'surfboard', 'bottle', 
 'cup', 'fork', 'knife', 'spoon', 'bowl', 'banana', 'apple', 
 'sandwich', 'orange', 'broccoli', 'carrot', 'pizza', 'donut', 
 'cake', 'chair', 'couch', 'bed', 'toilet', 'tv', 'laptop', 'mouse', 
 'remote', 'keyboard', 'microwave', 'oven', 'toaster', 'sink', 
 'refrigerator', 'book', 'clock', 'vase', 'scissors', 'toothbrush')


CLASSES_48 = ('person', 'bicycle', 'car', 'motorcycle', 'train', 
            'truck', 'boat', 'bench', 'bird', 'horse', 'sheep', 
            'bear', 'zebra', 'giraffe', 'backpack', 'handbag', 
            'suitcase', 'frisbee', 'skis', 'kite', 'surfboard', 
            'bottle', 'fork', 'spoon', 'bowl', 'banana', 'apple', 
            'sandwich', 'orange', 'broccoli', 'carrot', 'pizza', 
            'donut', 'chair', 'bed', 'toilet', 'tv', 'laptop', 
            'mouse', 'remote', 'microwave', 'oven', 'toaster', 
            'refrigerator', 'book', 'clock', 'vase', 'toothbrush')

#file_path = '/data/zhuoming/detection/uk_rpn/mask_rcnn_with_base48_tuned_clip_feat_r50_fpn_trirpn_1x_coco_base48_no_sigmoid/novel_results.bbox.json'
#file_path = '/data/zhuoming/detection/uk_rpn/mask_rcnn_with_base48_tuned_clip_feat_r50_fpn_trirpn_1x_coco_base48_no_sigmoid/base_results.bbox.json'
#file_path = '/data/zhuoming/detection/grad_clip_check/mask_rcnn_with_base48_tuned_clip_feat_r50_fpn_2x_coco_base48_gn_10_200clipproposal/base_results_65cates.bbox.json'
#file_path = '/data/zhuoming/detection/grad_clip_check/mask_rcnn_with_base48_tuned_clip_feat_r50_fpn_2x_coco_base48_gn_10_200clipproposal/novel_results_65cates.bbox.json'
#file_path = '/data/zhuoming/detection/grad_clip_check/mask_rcnn_with_base48_tuned_clip_feat_r50_fpn_2x_coco_base48_gn_10_200clipproposal/novel_gt_result.json'
#file_path = '/data/zhuoming/detection/grad_clip_check/mask_rcnn_with_base48_tuned_clip_feat_r50_fpn_2x_coco_base48_gn_10_200clipproposal/fixed_label_prediction.json'
#file_path = '/data/zhuoming/detection/grad_clip_check/mask_rcnn_with_base48_tuned_clip_feat_r50_fpn_2x_coco_base48_gn_10_200clipproposal/filter_fp_prediction.json'
#file_path = '/data/zhuoming/detection/grad_clip_check/mask_rcnn_with_base48_tuned_clip_feat_r50_fpn_2x_coco_base48_gn_10_200clipproposal/add_fn_prediction.json'
#file_path = '/data/zhuoming/detection/grad_clip_check/mask_rcnn_with_base48_tuned_clip_feat_r50_fpn_1x_coco_base48_use_bg_pro_60/novel_results_65cates.bbox.json'
#file_path = '/data/zhuoming/detection/grad_clip_check/mask_rcnn_with_base48_tuned_clip_feat_r50_fpn_2x_coco_base48_200clip_pro/base_results.bbox.json'
#file_path = '/home/zhuoming/final_pred_v1.json'
#file_path = '/data/zhuoming/detection/grad_clip_check/mask_rcnn_with_base48_tuned_clip_feat_r50_fpn_2x_coco_base48_200clip_pro/base_results_e18.bbox.json'

#file_path = '/data/zhuoming/detection/exp_res/mask_rcnn_r50_fpn_1x_coco_2gpu_base48/base_results.bbox.json'
#file_path = '/data/zhuoming/detection/grad_clip_check/mask_rcnn_with_base48_tuned_clip_feat_r50_fpn_1x_coco_base48_gn_10_200clipproposal/base_results.bbox.json'

#file_path = '/data/zhuoming/detection/exp_res/mask_rcnn_r50_fpn_1x_coco_2gpu_base48/filter_iop_prediction.json'
#file_path = '/data/zhuoming/detection/grad_clip_check/mask_rcnn_with_base48_tuned_clip_feat_r50_fpn_1x_coco_base48_gn_10_200clipproposal/filter_iop_prediction.json'
#file_path = '/data/zhuoming/detection/exp_res/mask_rcnn_r50_fpn_1x_coco_2gpu_base48/filter_iop_prediction_07.json'
#file_path = '/data/zhuoming/detection/grad_clip_check/mask_rcnn_with_base48_tuned_clip_feat_r50_fpn_1x_coco_base48_gn_10_200clipproposal/filter_iop_prediction_07.json'
#file_path = '/data/zhuoming/detection/exp_res/mask_rcnn_r50_fpn_1x_coco_2gpu_base48/filter_iop_prediction_05.json'
#file_path = '/data/zhuoming/detection/grad_clip_check/mask_rcnn_with_base48_tuned_clip_feat_r50_fpn_1x_coco_base48_gn_10_200clipproposal/filter_iop_prediction_05.json'
#file_path = '/data/zhuoming/detection/baseline/mask_rcnn_r50_fpn_1x_coco_detectron_2x8_base48/base_results.bbox.json'
file_path = '/data/zhuoming/detection/baseline/mask_rcnn_r50_fpn_1x_coco_detectron_2x8/base_results.bbox.json'

#ann_file = '/data/zhuoming/detection/coco/annotations/instances_val2017_65cates.json'
#ann_file = '/data/zhuoming/detection/coco/annotations/instances_val2017_novel17.json'
ann_file = '/data/zhuoming/detection/coco/annotations/instances_val2017_base48.json'

coco_object = COCO(ann_file)

# preparing the hyper-parameter of the evaluation
#cat_ids = coco_object.get_cat_ids(cat_names=CLASSES_65)
cat_ids = coco_object.get_cat_ids(cat_names=CLASSES_48)
img_ids = coco_object.get_img_ids()
proposal_nums=(100, 300, 1000)
#iou_thrs = np.linspace(.5, 0.95, int(np.round((0.95 - .5) / .05)) + 1, endpoint=True)
iou_thrs = np.array([0.5])
metric_items = ['mAP', 'mAP_50', 'mAP_75', 'mAP_s', 'mAP_m', 'mAP_l']


cocoGt = coco_object
predictions = mmcv.load(file_path)
cocoDt = cocoGt.loadRes(predictions)


cocoEval = COCOeval(cocoGt, cocoDt, 'bbox')
cocoEval.params.catIds = cat_ids
cocoEval.params.imgIds = img_ids
cocoEval.params.maxDets = list(proposal_nums)
cocoEval.params.iouThrs = iou_thrs

coco_metric_names = {
    'mAP': 0,
    'mAP_50': 1,
    'mAP_75': 2,
    'mAP_s': 3,
    'mAP_m': 4,
    'mAP_l': 5,
    'AR@100': 6,
    'AR@300': 7,
    'AR@1000': 8,
    'AR_s@1000': 9,
    'AR_m@1000': 10,
    'AR_l@1000': 11
}

cocoEval.evaluate()
cocoEval.accumulate()
cocoEval.summarize()

eval_results = OrderedDict()
for metric_item in metric_items:
    key = f'bboxes_{metric_item}'
    val = float(
        f'{cocoEval.stats[coco_metric_names[metric_item]]:.3f}'
    )
    eval_results[key] = val

print(cocoEval.eval['precision'].shape)
#(10, 101, 65, 4, 3)
print(cocoEval.params.recThrs)
# [0.   0.01 0.02 0.03 0.04 0.05 0.06 0.07 0.08 0.09 0.1  0.11 0.12 0.13
#  0.14 0.15 0.16 0.17 0.18 0.19 0.2  0.21 0.22 0.23 0.24 0.25 0.26 0.27
#  0.28 0.29 0.3  0.31 0.32 0.33 0.34 0.35 0.36 0.37 0.38 0.39 0.4  0.41
#  0.42 0.43 0.44 0.45 0.46 0.47 0.48 0.49 0.5  0.51 0.52 0.53 0.54 0.55
#  0.56 0.57 0.58 0.59 0.6  0.61 0.62 0.63 0.64 0.65 0.66 0.67 0.68 0.69
#  0.7  0.71 0.72 0.73 0.74 0.75 0.76 0.77 0.78 0.79 0.8  0.81 0.82 0.83
#  0.84 0.85 0.86 0.87 0.88 0.89 0.9  0.91 0.92 0.93 0.94 0.95 0.96 0.97
#  0.98 0.99 1.  ]
all_precision = cocoEval.eval['precision']
with open('test.npy', 'wb') as f:
    np.save(f, all_precision)

import torch
all_precision = torch.from_numpy(all_precision)
all_precision = all_precision.permute([1,0,2,3,4])
precision_over_recall = [torch.mean(ele[ele>-1]).item() for ele in all_precision]
print(len(precision_over_recall), sum(precision_over_recall)/len(precision_over_recall))
print(precision_over_recall)
# precision_over_recall = torch.mean(all_precision[all_precision>-1], dim=(1,2,3,4))
#print(np.mean(temp[temp>-1]))
#0.3284804737520371


# visulization
import matplotlib as mpl
import matplotlib.pyplot as plt
x = [0.,0.01,0.02,0.03,0.04,0.05,0.06,0.07,0.08,0.09,0.1,0.11,0.12,0.13
,0.14,0.15,0.16,0.17,0.18,0.19,0.2,0.21,0.22,0.23,0.24,0.25,0.26,0.27
,0.28,0.29,0.3,0.31,0.32,0.33,0.34,0.35,0.36,0.37,0.38,0.39,0.4,0.41
,0.42,0.43,0.44,0.45,0.46,0.47,0.48,0.49,0.5,0.51,0.52,0.53,0.54,0.55
,0.56,0.57,0.58,0.59,0.6,0.61,0.62,0.63,0.64,0.65,0.66,0.67,0.68,0.69
,0.7,0.71,0.72,0.73,0.74,0.75,0.76,0.77,0.78,0.79,0.8,0.81,0.82,0.83
,0.84,0.85,0.86,0.87,0.88,0.89,0.9,0.91,0.92,0.93,0.94,0.95,0.96,0.97
,0.98,0.99,1.,]
# base_y=[0.8293181887133676, 0.7931063172741163, 0.7633451337242759, 
#         0.7427780956870432, 0.7262229718615569, 0.7122512187103852, 
#         0.6917808956877, 0.6808351299514392, 0.6679963953984451, 
#         0.6570176471745749, 0.6476103979909864, 0.6354206562857616, 
#         0.6250861646360141, 0.6156410739573375, 0.6075577501628038, 
#         0.5913820048204824, 0.5817274061734342, 0.5728288272052573, 
#         0.5642029726707156, 0.557516206973082, 0.5502973462897156, 
#         0.536508369376122, 0.527086817258789, 0.517483400740076, 
#         0.5102627423702993, 0.5040323715824889, 0.4933612009352585, 
#         0.4859249349680214, 0.4771868229414248, 0.46880052508475767, 
#         0.4623128020376746, 0.45437302732764223, 0.44669028998025845, 
#         0.43923250474517367, 0.42727326818971584, 0.4204006285879569, 
#         0.4127120024801429, 0.40514053547437295, 0.398709327078212, 
#         0.3907913605959056, 0.38484534122981146, 0.3771390073019012, 
#         0.3697601184036317, 0.36258323550131705, 0.3558900573181154, 
#         0.349300263991941, 0.34222963572077725, 0.33411506665066465, 
#         0.32741811712491603, 0.3210524399320401, 0.3162422340907629, 
#         0.2994493381936549, 0.2934336190729968, 0.28649122261997473, 
#         0.2799402245140299, 0.27348270163495586, 0.26641184285642877, 
#         0.25856624596696287, 0.25120113211342054, 0.2440790854756159, 
#         0.239011514814986, 0.23064391472864937, 0.22325847769310603, 
#         0.2170487197394041, 0.21012655813568376, 0.2030457619710547, 
#         0.19515370825636924, 0.18595013667941146, 0.1794890012625989, 
#         0.17251197060556026, 0.1651884688705093, 0.1592952561991061, 
#         0.1525498066828376, 0.14424366833015256, 0.13807372121899936, 
#         0.1323645208048313, 0.12525390714322657, 0.1177758339596525, 
#         0.10861159502504367, 0.10252267072033355, 0.09672137929210509, 
#         0.0901489332853848, 0.08345604036642972, 0.07767524178278871, 
#         0.06923408820592455, 0.06381949202746136, 0.05680502259000153, 
#         0.05159423888885363, 0.044680314408862346, 0.03964005473562236, 
#         0.03600779572653488, 0.03129089648939861, 0.027810630974274553, 
#         0.024126368784161134, 0.020113557811023794, 0.017820298455737044, 
#         0.014868041985221585, 0.012850824268004019, 0.010934374765425395, 
#         0.009797671645157262, 0.009176706809144378]
# novel_y = [0.8468289391712415, 0.8192170187908953, 0.7925871647191154, 
#            0.7750011529736598, 0.7589447159795967, 0.7473283212941294, 
#            0.7265891849596255, 0.717120872624342, 0.7024693467592179, 
#            0.6902793229909789, 0.68117946767374, 0.6681725444376772, 
#            0.6568118529765622, 0.643924241301934, 0.6372812229730697, 
#            0.6260383289786776, 0.6167146728900571, 0.6079110887127359, 
#            0.5998311126160333, 0.5927123362150951, 0.5863743710193872, 
#            0.5753557066615878, 0.5675347394213481, 0.55769423261846, 
#            0.5491871934007991, 0.5428858568271796, 0.5299454432497493, 
#            0.5238040791387941, 0.514785523942957, 0.5067767093867802, 
#            0.5000094769411275, 0.49133516013890505, 0.48456051078555595, 
#            0.47792759281935415, 0.46899448648220826, 0.46166142591017023, 
#            0.453484457299936, 0.4461428853004338, 0.43866124202301704, 
#            0.43069614778637183, 0.4246184986999233, 0.41464783168556013, 
#            0.4079494949460846, 0.39947737026452246, 0.3928562505786106, 
#            0.3856324944916786, 0.379324069288054, 0.37036943555827406, 
#            0.36336751605071793, 0.35734733583146766, 0.3516368985436595, 
#            0.33262976057642485, 0.32576926636884224, 0.3182574742474945,
#            0.311181547811726, 0.3040781259602019, 0.2958871117150965, 
#            0.2883216532573259, 0.281890313228015, 0.2741954950263533, 
#            0.2681904334706938, 0.25695063943324437, 0.24871803911346646, 
#            0.24122076108907747, 0.23431323519787933, 0.22744211277239598, 
#            0.21961631431133438, 0.20817272801370812, 0.2011224031585182, 
#            0.19351261863151348, 0.18548507583631585, 0.17881221602817104, 
#            0.1714291132064254, 0.16247700647962066, 0.15590701080650268, 
#            0.149137458548474, 0.14144553363473444, 0.1341908691957253, 
#            0.12572735888756784, 0.11810795741082178, 0.11202898118221756, 
#            0.10369672556782651, 0.09683599265041308, 0.09097614851401216, 
#            0.08335713133684533, 0.07726109103810032, 0.07080203509426765, 
#            0.06408455683148806, 0.05853780659920449, 0.051517076913084915, 
#            0.046619813480559734, 0.04037233070670526, 0.035417258453984975, 
#            0.029764055528755013, 0.02505589270703687, 0.020354233413252647, 
#            0.016436943358263463, 0.01313828222411547, 0.010586286562286064, 
#            0.00828260577621895, 0.007613479946836482]
# plt.plot(x, base_y , color='red', label='mAP = 0.328')
# plt.plot(x, novel_y , color='green', label='mAP = 0.355')

# base_y = [0.8447217621071962, 0.807090629390678, 0.7777217410515146, 0.7550662918200793, 0.7384290791125824, 0.7224424727101451, 0.7048670101030364, 0.6924654447511227, 0.6775388291013794, 0.6661802404062163, 0.6573203806406231, 0.646228388072737, 0.6347533072710219, 0.6242604621242516, 0.6173548918315597, 0.602630137457733, 0.5932388654563197, 0.5829833399154918, 0.5751559505485719, 0.5675724641077505, 0.5605122671655118, 0.5498329571099649, 0.5429645122415866, 0.5350684636244486, 0.5275962838246345, 0.5222082729983955, 0.5112689898194189, 0.5043764565230132, 0.4965560619322763, 0.4882632900535897, 0.48210867660410445, 0.4739182369867076, 0.466535538265229, 0.4593104005678428, 0.450960048335987, 0.4427978014787876, 0.4347388669201482, 0.42784946040508753, 0.42157503424157833, 0.4129832115733218, 0.4070332810046112, 0.3987124442022736, 0.39200340095713926, 0.3844143975038685, 0.3774474066236692, 0.3693983478181009, 0.36205311678121943, 0.3554819765326312, 0.3491005095802719, 0.34249172342811063, 0.3369567108852815, 0.3176632596875053, 0.31111801298071773, 0.3038029998613979, 0.29561402836664974, 0.28940477331317527, 0.281644563249878, 0.2750628129779969, 0.26929730506931776, 0.26242334886225627, 0.2571083145310356, 0.24801326399705398, 0.23991400295029833, 0.2327307898098159, 0.2243881082117189, 0.2150949400658262, 0.2079087657937204, 0.19735588072905932, 0.19055195860400517, 0.18366644566235632, 0.17564705671881803, 0.1689594780724355, 0.16273118951071247, 0.15444443015673898, 0.14774727257431208, 0.1412290105370252, 0.13344730489662557, 0.12553719675498487, 0.11618415173384176, 0.10987485343120977, 0.1046359699168071, 0.09752209380867703, 0.0905965739258574, 0.08434168071469914, 0.07678535087439038, 0.07027466291233618, 0.06444124808522722, 0.058215741842537444, 0.05137598659957402, 0.044561829245019266, 0.03966311950428144, 0.034332025278761086, 0.029963103227322485, 0.025784472800171473, 0.021451212887006577, 0.01827332051692813, 0.014359019250735228, 0.01187677121104506, 0.009916431011852384, 0.008513389463732163, 0.008108659678193129]
# novel_y = [0.5983272442885412, 0.5649283471111336, 0.5231127816848139, 0.4897888148608, 0.47085128041688334, 0.45641461106647413, 0.4314389132599257, 0.41682320020293717, 0.40033339421525926, 0.38267926877675135, 0.37653011019552396, 0.3646160517128149, 0.3468670913828559, 0.3367106871333424, 0.3246617318789771, 0.3161010558955712, 0.3046766373044399, 0.2904454159110654, 0.2833876371554195, 0.2783571824515809, 0.272088266851994, 0.25988735777472416, 0.25097404039097426, 0.24481647760943223, 0.23865226128949482, 0.23155980507500998, 0.22228355273341344, 0.21384335661185053, 0.20711913491369938, 0.20249450383999665, 0.19687500093080107, 0.1892029524525358, 0.18555751639867468, 0.17849222964107303, 0.17229523058799526, 0.16795377767971695, 0.1637783094162995, 0.15970179964576758, 0.15391043551811828, 0.15052579565852034, 0.1461356081647149, 0.13854657826007333, 0.13445999079599671, 0.1307475247334012, 0.12665106968677434, 0.12243376628181439, 0.11890644935612016, 0.11521335143661056, 0.11096193268674638, 0.10618451762411303, 0.1043583284061621, 0.09848291154708869, 0.09444175705492076, 0.09130231361635822, 0.0877910101669339, 0.08472320772930639, 0.08180002756096891, 0.07805536597983835, 0.0752852243637957, 0.07168813517830354, 0.06886789865745636, 0.06565338227753705, 0.0626689379822846, 0.0596726463388187, 0.05736602294797664, 0.053953152173865634, 0.05150899293540402, 0.04916273207729971, 0.046152072838354964, 0.0437359831463212, 0.04141592987468555, 0.03896593667851146, 0.03716088077595757, 0.03482497748286407, 0.0325185550222492, 0.030117276577954915, 0.02752942475955588, 0.02550287333696153, 0.02381302039026227, 0.02172469945882878, 0.020325705469842515, 0.01869294629349571, 0.016892137746673083, 0.015401503836485734, 0.013804117929213431, 0.012181428687347406, 0.011157623620302756, 0.009676494415275806, 0.008155847453948255, 0.007259910894168613, 0.005766153680402249, 0.004331822944500602, 0.003633086668514754, 0.003099534358172933, 0.0026399659456655166, 0.0020375693391979787, 0.0011571916401413255, 0.0007316607222156111, 0.0004141876565899028, 0.00018867029319269245, 0.00018867029319269245]
# plt.plot(x, base_y , color='red', label='base')
# plt.plot(x, novel_y , color='green', label='novel')

# for filter fp
# optimal_result_y = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
# base_y = [0.9643666952260703, 0.9575310885597746, 0.9498916581032487, 0.9445533607186657, 0.9376082361291821, 0.9299383770097067, 0.9191652158087967, 0.9152043184515433, 0.907156701155031, 0.9010638708606807, 0.8955071579122832, 0.8861190343133745, 0.8781467258566712, 0.8737132687906972, 0.8701076439489053, 0.8575587113506232, 0.8485349272501074, 0.8385515508929101, 0.831176601594505, 0.8236577321486372, 0.8168804998070954, 0.8076205582686398, 0.8016708034219353, 0.795206697023431, 0.7895573222561441, 0.7851717127015859, 0.7742051541530423, 0.7681984566443668, 0.7605650071769525, 0.7513853375356208, 0.7448484354141532, 0.7380843624136758, 0.7307424152500414, 0.7245587235330047, 0.7190442655704746, 0.7119228872126336, 0.7038501319553032, 0.696562070687508, 0.6901269194924932, 0.6798271981323373, 0.6732779596343939, 0.663844182574012, 0.6569493257293898, 0.6487694164682744, 0.6426195441528896, 0.6339332113270726, 0.625237538117751, 0.6188486120645452, 0.6113160147040276, 0.6048067201691156, 0.5968794785805143, 0.5701096569143095, 0.5623849977279778, 0.5536751608004877, 0.5440032995159206, 0.5349359546469253, 0.5241157925763118, 0.5160678623935602, 0.5083227090475513, 0.49935449836265966, 0.4933570830594161, 0.4821220750403771, 0.47068448975838095, 0.46153419037095644, 0.4519802814074936, 0.4405192703549345, 0.42920139812955493, 0.4146409313486727, 0.4052589444024851, 0.3960812292885317, 0.38648950660128667, 0.37590002235193043, 0.3666187577056625, 0.35451609758690467, 0.3444645733450419, 0.3343518958412586, 0.32170187192096666, 0.3065748675190749, 0.2947563851510393, 0.2831487464704905, 0.2738675986494623, 0.25828717504900656, 0.243952809109529, 0.23073071940811207, 0.21433395826971913, 0.20235144995390644, 0.18785471289615935, 0.17447249432706202, 0.16229674167383457, 0.14256717343728803, 0.1288836270909708, 0.11148756289011377, 0.0992640004474062, 0.08882013554360994, 0.07435961759571678, 0.06319113402263138, 0.05052437222981691, 0.039703920585503344, 0.02930461113396242, 0.02120186883306798, 0.018731649787862965]
# novel_y = [0.7909457889812436, 0.7754127427710668, 0.7583901168583188, 0.719159846359752, 0.7038295569730784, 0.6958075481477737, 0.6657763877342634, 0.6483710434226154, 0.6214127485406493, 0.6041045978001851, 0.5949527295600026, 0.5898621042444104, 0.5765276849023504, 0.5635382901659588, 0.5462856445657313, 0.5385072393729269, 0.5206789586500158, 0.5015542426683236, 0.4966462099985395, 0.48981230896211875, 0.48322827044982375, 0.46920142572611073, 0.46191240612857426, 0.45489197097347506, 0.44645723614690247, 0.43597409681933413, 0.425143737911287, 0.4111334237486244, 0.40292641716884064, 0.39423228459255855, 0.3897044569053568, 0.3768106412554921, 0.3735379616117428, 0.3572923461816972, 0.3467312000646917, 0.3394480030330004, 0.3338806544433885, 0.3301051051363891, 0.32353319346394716, 0.3190569740071039, 0.3123747761434829, 0.2934664915812451, 0.2849879943002165, 0.28048315070341695, 0.27354946089068144, 0.2670310752221578, 0.2608833035274455, 0.2575450005805133, 0.2509858955891709, 0.24101929370458897, 0.23866295008102992, 0.22638124175456936, 0.21925484722463368, 0.21451035225154003, 0.20634682845336685, 0.1997825826549159, 0.19481618553794586, 0.18767944350151142, 0.18295485769212771, 0.17522926721820478, 0.17142939396834714, 0.16448513668673292, 0.15871901110431388, 0.15359003060039697, 0.14869936040192852, 0.14193428176530343, 0.13644445970670196, 0.1316630696318258, 0.1257469261271332, 0.11978580723418437, 0.11642668876760853, 0.11090320005080725, 0.10680598547700992, 0.10131634923337428, 0.09575850515582485, 0.08670376156929387, 0.0787125221025146, 0.07473662242319036, 0.06948868264502699, 0.06460288242013872, 0.06061749617350245, 0.05666314676272182, 0.05400717976434004, 0.04978744287943067, 0.04682838372658358, 0.04328631044544755, 0.03857111223274519, 0.03503775700862666, 0.029963218857621755, 0.026553864433122937, 0.022904995210771825, 0.018125957153653234, 0.015074992303396418, 0.013731127655984783, 0.01211651849210043, 0.008620554936246982, 0.006719459419065463, 0.00460201345139651, 0.0031993262587316483, 0.0009441526247595448, 0.0009441526247595448]
# #fixed_novel_y = [0.9004572586817957, 0.6738958281077824, 0.5317639388595061, 0.439499711132719, 0.4151746116212544, 0.38464988205009903, 0.3343536310037676, 0.3168466624654555, 0.30074663350985015, 0.2969431425047356, 0.29570442626513965, 0.2873311361971254, 0.2801746917552011, 0.2719334426355253, 0.26303123749279034, 0.25964545607253453, 0.25372183434979945, 0.24786233998007623, 0.23913898244658038, 0.23881732499214534, 0.23737557814769067, 0.23182439861287668, 0.23101455609571092, 0.21504842418167067, 0.2132013467560952, 0.21306344564702695, 0.20217221872774763, 0.20126104580308926, 0.20022875803734386, 0.1998778095847965, 0.19820719487685953, 0.189927628784385, 0.18820197190479915, 0.18766490395895816, 0.18599187036578013, 0.18520582108337366, 0.18390838174645652, 0.18362903205785563, 0.18210789163738883, 0.17979166533404828, 0.17934205191542918, 0.17805039688805882, 0.1764095057295653, 0.1753778351018456, 0.16881805528488344, 0.1665552527607644, 0.16601824512537647, 0.1559079612508886, 0.15550321263360928, 0.15521774711620015, 0.15515628071715054, 0.15189160537156296, 0.1514675876136008, 0.150965942480921, 0.14597043227624945, 0.1459432545931184, 0.1459181502117432, 0.14581294417919616, 0.14559363763250244, 0.1393279210697383, 0.13661846433014024, 0.13647139798288951, 0.1333358763786143, 0.13318747430380642, 0.12886207610801698, 0.12833922708028983, 0.12794351846534674, 0.12294530404964071, 0.122264944261637, 0.12215153494866358, 0.1163430144006123, 0.11491596497899241, 0.11323684181366424, 0.10613090255160473, 0.1054789468525129, 0.1054140051547476, 0.09331382662436383, 0.09296064776172695, 0.08537865632859501, 0.08527919598811691, 0.08514406564702443, 0.08473518834491835, 0.08038808050168601, 0.07976333748620582, 0.075184806676308, 0.07203283354608045, 0.07134862249870502, 0.06924976233558663, 0.06901944211285958, 0.0669890036187855, 0.06241764851013631, 0.058885789401960424, 0.05546334374017198, 0.052467786614504866, 0.04344391940500727, 0.03897137852012375, 0.0319213495152219, 0.030540884784233842, 0.02517128767348656, 0.009638490909430288, 0.009638490909430288]
# filter_fp_novel_y = [0.9908088235294118, 0.9385055911478469, 0.9022916340630774, 0.8842505549151872, 0.8777108681022471, 0.8716875970356094, 0.8578267765120332, 0.8358212867260078, 0.8158911871963477, 0.7826811533224499, 0.7768317168498502, 0.7752812897693067, 0.773818114786395, 0.771102213360455, 0.771102213360455, 0.7707251394539694, 0.7678433436477481, 0.7671169275264486, 0.7658212336636191, 0.7638407764561799, 0.7458959982172839, 0.7444727277712431, 0.7293249280006812, 0.7169692008987065, 0.714090141451541, 0.7137542109082817, 0.6969541820732182, 0.6969148557966873, 0.695889670947973, 0.6946385384112618, 0.6932027936934112, 0.6793297333771504, 0.6786511253256136, 0.677800827710659, 0.6776964098294245, 0.6521986466586509, 0.6517371942792326, 0.651684287034072, 0.6359437438276583, 0.6359306369806413, 0.6351313342784992, 0.6342728288500461, 0.6196068582850413, 0.6190658118323248, 0.6188299086475704, 0.6033367988353586, 0.590735809316978, 0.5894861657668906, 0.5747724665144378, 0.5734729150793247, 0.573118478885169, 0.5578413349781948, 0.5574658355616369, 0.5571635877802864, 0.5569822650881432, 0.5567888464828162, 0.5271862574400293, 0.5271223224312114, 0.5010750552517081, 0.5002320080581407, 0.49042205273829165, 0.4893153696656013, 0.44963560784887485, 0.4390483202111877, 0.4389618150208763, 0.43889896936979533, 0.4388197744772567, 0.42587507563963783, 0.4039656982141419, 0.38995469418377, 0.3897839913076869, 0.37413923097708607, 0.3736928560358152, 0.3625772149154385, 0.33967375563326224, 0.3146413610135093, 0.2959730613989044, 0.29582148045578877, 0.29563883477141295, 0.2735245441809021, 0.2609821792814232, 0.24280290173960828, 0.2427110431338178, 0.22167940780821374, 0.2214079991874686, 0.21148828866594144, 0.20169686491540567, 0.19024553607382924, 0.17171117127910335, 0.15899970834663413, 0.13456371153564956, 0.09527188028604044, 0.08247054310779973, 0.08241284906617043, 0.07473984376058936, 0.05657525144415837, 0.04954200336231694, 0.04240137873893113, 0.032071801630755126, 0.01197841641674735, 0.01197841641674735]
# filter_fp_base_y = [0.9624388728555395, 0.9080926175267628, 0.8756098625727122, 0.8573008275031153, 0.8422193025410164, 0.8276124513722548, 0.819783532136078, 0.812134615178211, 0.7993752574924348, 0.791933012060118, 0.7872445366208358, 0.7843538898316111, 0.7800613989892748, 0.7782715356593628, 0.7772989339556484, 0.7760795558582828, 0.7747167362433794, 0.7733496991814736, 0.7715025212954784, 0.768576693781073, 0.7677610262176846, 0.7657519358666816, 0.7649227172127699, 0.7626647956878596, 0.7619346939516833, 0.7611939435071098, 0.7561361680759603, 0.7556293560042882, 0.7537567670017363, 0.7522103919459631, 0.7513776447561162, 0.7489064855931513, 0.7482041736937841, 0.7477084865205857, 0.7429188935323352, 0.7423222667387338, 0.7418245040676548, 0.7411328292350134, 0.7400143491909383, 0.7391183977281384, 0.7388765367986839, 0.7379725878107569, 0.7367548098296354, 0.7310232474821218, 0.7302744454130452, 0.729633105097664, 0.7291966096246921, 0.728784171676897, 0.7280123862577843, 0.7225883775927165, 0.7220989016656998, 0.7137821377696777, 0.7086520152497485, 0.7076645472624222, 0.7070548178415585, 0.7066952449239392, 0.7020052754781461, 0.7012125693634448, 0.7010105036594756, 0.7008031139712811, 0.687124397790028, 0.6867334221921619, 0.6831010142958767, 0.6828337888115755, 0.6781046933935532, 0.6687574335611298, 0.6630925022210722, 0.650686244584599, 0.6461884937160276, 0.6367419787311336, 0.6320844204904768, 0.610394811107994, 0.6011212510643876, 0.5925199824948755, 0.5874978178983663, 0.586977374762066, 0.5693871136167792, 0.5516210161105244, 0.5340794200279905, 0.5229782774289944, 0.5072659048343914, 0.4778922221449809, 0.4716417143819953, 0.4676835644804872, 0.4514578607297543, 0.4338528309815205, 0.4235052361005776, 0.4006601359523915, 0.3801383547263596, 0.3564548422196349, 0.3486226545815334, 0.3315467097432074, 0.30035913055117297, 0.27500533181843634, 0.2638413657229937, 0.22330506789084462, 0.18807684008129322, 0.15354875720906777, 0.10627003482644456, 0.0730822229370885, 0.06085582409246401]

# add_fn_base_y = [0.9835792824074076, 0.9835792824074076, 0.9835792824074076, 0.9830584490740739, 0.9830584490740739, 0.9816455501379038, 0.979913797767219, 0.9792627561005524, 0.9778414690090352, 0.9767749582486205, 0.9766069474959325, 0.9757269559641042, 0.9747033077335163, 0.9736681105693354, 0.9721595323693764, 0.9686767386287521, 0.9660071522662932, 0.9639680181023034, 0.9625713782537362, 0.959625007911355, 0.9582031245775933, 0.9538774153783254, 0.9496342539552997, 0.9453219363337964, 0.9423604978608265, 0.9400636218561897, 0.9330106894700716, 0.9302483058836102, 0.9252560451662151, 0.9203307998265066, 0.9164217922455317, 0.9123421692649545, 0.9069994316161076, 0.9035268004804043, 0.8983844081278602, 0.8945487161547435, 0.8864373526723698, 0.8808854088877547, 0.8756882307045928, 0.8702117665162599, 0.8648388028864169, 0.854790367135977, 0.8488855822028074, 0.8418217856922356, 0.8365074041341389, 0.8297624302786537, 0.8229563941843738, 0.817776033597329, 0.8118004204850426, 0.8059561991086964, 0.8007117807983954, 0.777047868690746, 0.7723057494209079, 0.7641588325742459, 0.7568710997786922, 0.7490130361867166, 0.7366962251759936, 0.7278513272030916, 0.7190217332490939, 0.7098564509142319, 0.7013413277111284, 0.6927263430054804, 0.6815067664822991, 0.6733285898819137, 0.6644797108203455, 0.6514907831349674, 0.6401275705802836, 0.625986238767754, 0.6152947429308896, 0.6050919207308252, 0.5922253372253715, 0.5811583583767774, 0.5661656738869298, 0.5516492584096687, 0.5407243610091671, 0.5297791045245979, 0.5175018565239187, 0.5037928758024793, 0.4894963108094104, 0.4754189081309752, 0.46262200462866965, 0.4386132289423837, 0.4263141258160547, 0.4088322682661346, 0.39070861258954787, 0.3720410438726137, 0.35310360480737857, 0.3346295420610132, 0.31444170690128714, 0.2846623929185437, 0.2629112385080608, 0.23985979008281744, 0.2182904464676617, 0.19408699935870166, 0.1734927659413282, 0.15395800232249057, 0.12986437678529128, 0.11154094553435599, 0.08980432456515011, 0.066100206230769, 0.04927684339162264]
# add_fn_novel_y = [1.0, 1.0, 0.9986631016042781, 0.9986631016042781, 0.9986631016042781, 0.9986631016042781, 0.9888591800356508, 0.9888591800356508, 0.9730903034242326, 0.9718648132281541, 0.9718648132281541, 0.9703265230869228, 0.9653264576974415, 0.9611826438393588, 0.9558594711980608, 0.9553294864768997, 0.9429494720617927, 0.936649432012461, 0.9337458633648541, 0.9320595068179236, 0.9195987823486982, 0.9104635506735487, 0.9065377531694746, 0.893705325714704, 0.878669125957033, 0.8747053128700887, 0.8489895774180115, 0.8348123469559617, 0.8289024719025567, 0.8127934657700854, 0.7971270566004368, 0.7897143794084569, 0.7848379268516098, 0.7796150094843639, 0.7675996041042651, 0.7606374586504844, 0.7473882375989296, 0.7399149468594344, 0.7275370408135861, 0.7216041652499982, 0.7138751779843078, 0.6948243667342435, 0.6837357762650802, 0.6577653847707857, 0.6516622854564869, 0.6413600195415669, 0.629443010773553, 0.6162868349433923, 0.6075609393826766, 0.5976677358357853, 0.5922484555284315, 0.574315391737589, 0.566744739902959, 0.5556392079807803, 0.5451878601055541, 0.5370259918413288, 0.513840948367127, 0.5043578171639904, 0.4963434553897762, 0.48894830733527594, 0.47951420321659116, 0.45618192367140864, 0.43447387624022904, 0.4228157993446624, 0.4138031993071401, 0.40549527591015855, 0.3953643720753778, 0.38417870258324954, 0.3731515032553941, 0.3624899240307693, 0.3501964543591571, 0.3395782350233928, 0.32686320273691477, 0.31580769371342965, 0.3042645570131842, 0.2970915294801039, 0.27677519932074934, 0.2560411626195867, 0.2457969869530282, 0.23340020919030297, 0.22399656226631548, 0.20835902131639222, 0.19802602065849956, 0.1846316136278649, 0.16784201713881763, 0.15678810825157696, 0.14651700105058918, 0.13509939834360726, 0.12583543387268634, 0.11035577240606453, 0.09572585360723644, 0.08917314935436961, 0.0821466014934013, 0.07371103145347885, 0.06478356926778468, 0.05633291221081135, 0.04911181661069924, 0.04194001629912418, 0.03333469987682852, 0.020262720610771993, 0.010069121263729703]

# for filter iop
# baseline_wo_filter = [0.8492913521057858, 0.8209988938369267, 0.7933822550744659, 0.7757238156202589, 0.7596617106604533, 0.7477563263039043, 0.726997395541311, 0.7175214509750034, 0.7028738562422473, 0.6906975237834152, 0.6816171864008405, 0.6687828459702, 0.657443361356914, 0.6446266052282779, 0.637946441191977, 0.6267389140665576, 0.6174389929134627, 0.6086160070477393, 0.6004664044831851, 0.5934095011118531, 0.5871472715817677, 0.5761269020907106, 0.568317127878516, 0.5584961493070069, 0.5500187252358403, 0.5436843377420211, 0.5307620795678814, 0.5246403660753457, 0.5156318407343431, 0.5076274439875958, 0.5008764738252174, 0.49222186890717606, 0.4854702250573076, 0.47882937510729623, 0.46992845056403243, 0.4625857659758681, 0.45442952620548716, 0.44707121775591013, 0.43960126949306644, 0.4316155537766319, 0.42554820730686005, 0.4156020710900904, 0.4089539405206646, 0.40050868373813836, 0.39392498139553506, 0.3867061387895581, 0.38038107216544825, 0.3714269126437993, 0.3644073905408414, 0.35838429086763424, 0.3526771105583013, 0.3337233514283268, 0.3268554670338912, 0.3193232485116722, 0.3123230152821182, 0.3051992504471053, 0.29703271598469366, 0.2894570951043914, 0.28301947749042755, 0.27530361124767794, 0.2692983216831789, 0.258063317252831, 0.24985863127635824, 0.24235958645714936, 0.23543469911840198, 0.22853090404694992, 0.22070928777127163, 0.2092786993221568, 0.20220804331632236, 0.19458818203846429, 0.18657327572362858, 0.17985740086604732, 0.17243390574284934, 0.16346871884029465, 0.15688325511789786, 0.15013131918922076, 0.14239527282565342, 0.13507381138154653, 0.12659568450135006, 0.11900873371062998, 0.1128861559377547, 0.10453640335071065, 0.0976468084255511, 0.09175450050003141, 0.0841227664345443, 0.07798146976194084, 0.071453918372625, 0.06470332716161753, 0.05912787212589028, 0.052087172803219416, 0.0471632530057729, 0.04089476244796165, 0.03587722130815994, 0.03016494405283136, 0.025424792546288908, 0.02065715226027852, 0.016681426969478618, 0.013343580979365723, 0.010742989598813701, 0.008400098565176123, 0.007721881712981548]
# our_wo_filter = [0.838672683696605, 0.8035983157273952, 0.7745630801132437, 0.7523446205218458, 0.7340840710556769, 0.7198292735706818, 0.701118061971887, 0.6901321972499549, 0.676214314624922, 0.6632035497895059, 0.6545404595033131, 0.6425137010902704, 0.6328328338513968, 0.6225647795705265, 0.6151147010932368, 0.6005891978137398, 0.5921640243282861, 0.5829197363763742, 0.5751414998378479, 0.5671584970326091, 0.5607783150465351, 0.5493543091765682, 0.5412892148961315, 0.531179822011732, 0.523924353923603, 0.5177227097359544, 0.5073992444787657, 0.5006592428595601, 0.4926624349493986, 0.4850383306669859, 0.4790047863413011, 0.4707417939393688, 0.4641539196281676, 0.4576809841999527, 0.4492563150127167, 0.4418779294517131, 0.4336371813791684, 0.4264188782874541, 0.41977097261481433, 0.41198568281098513, 0.4056250081047515, 0.3977449718782843, 0.39060888182735887, 0.3829422748931724, 0.3758569957546693, 0.36809814394918083, 0.36091716293397097, 0.35444070952382695, 0.347985098088118, 0.34120147170716636, 0.33546665749625354, 0.3173309600667107, 0.31099348676287975, 0.3037896721450991, 0.29658170393396205, 0.28973343744387514, 0.28226973653937215, 0.2749947917899827, 0.26878274278398917, 0.2620909925225949, 0.2567632367240525, 0.24766986990912104, 0.23949343792584502, 0.23257006550525994, 0.2247307715793755, 0.21628450749877928, 0.20903522027450694, 0.1985107135005405, 0.19129113047389437, 0.18470796142365778, 0.17708938633002225, 0.17088635705914348, 0.16363998631701143, 0.1552894115617434, 0.14887097801072874, 0.14271054827017748, 0.13500167985777708, 0.1269053329509164, 0.11869921941880097, 0.11191716721913936, 0.10630112206076978, 0.09932095725287418, 0.09212959542851352, 0.0855604872411902, 0.07811599619695882, 0.0716647767479469, 0.06578269088357135, 0.05983310835728217, 0.05319350573805332, 0.04524281687641706, 0.04052631536533332, 0.03541185343048623, 0.03133424296910838, 0.026884778160930524, 0.022340608721204344, 0.019203641828011927, 0.015389052051361256, 0.012797081290145744, 0.01038342881008657, 0.009054735569460045, 0.008729457117023536]
# baseline_w_filter = [0.8539099381623466, 0.828108856502375, 0.8038717541348892, 0.7872490828219187, 0.7723621046056423, 0.7605731668747379, 0.7422251219035298, 0.7335220693671406, 0.7200032336697332, 0.708274937001901, 0.7000530772150186, 0.6878752313351832, 0.6773236864333839, 0.6649801678035326, 0.658647086540206, 0.6475884848591965, 0.6385792132319698, 0.6304304897735968, 0.622616044177333, 0.6161269052880743, 0.6101433599111262, 0.5994950669955412, 0.5920980529455165, 0.5823126082129548, 0.5740978104443788, 0.5681535778382251, 0.5553038756878796, 0.5492250830595597, 0.5402909449650004, 0.5325648889426826, 0.5258587880369606, 0.5176883208510458, 0.5109275370501245, 0.5043132777668783, 0.49540987680340137, 0.48800452318038273, 0.47950146667649923, 0.4719427483100155, 0.4644029998342994, 0.4561372571013027, 0.449978941441744, 0.4398726620337771, 0.4330826262400738, 0.42485513852521944, 0.41791651315063005, 0.4103362656577541, 0.4036596679310789, 0.3943928973126098, 0.3869705294075802, 0.38056447414078903, 0.3744862299551866, 0.35485467833785705, 0.34767600181642755, 0.3398544800977079, 0.3323390955491667, 0.3247273255797416, 0.31617590548158475, 0.30833562146992183, 0.30168289226896705, 0.293500878062828, 0.2870405929918857, 0.2754043339231467, 0.266665194138899, 0.25893712419379794, 0.25152580710365907, 0.24434953787716224, 0.23620329333234164, 0.22446600051143414, 0.21683245168774154, 0.2090007500862058, 0.20058404715271405, 0.19357413373442553, 0.18575270129669927, 0.1762423733858571, 0.16918609349964508, 0.16204858578772952, 0.15393011926444242, 0.14591306527747303, 0.13680871303387107, 0.12878517013345975, 0.12240235620458054, 0.11363711864984602, 0.10615497336173006, 0.10001982814247182, 0.09183634889147539, 0.08524505935690987, 0.07839066804506462, 0.07136552444859909, 0.06542569994968651, 0.05789430563773816, 0.052554849810040286, 0.04599405749491326, 0.040632643756263735, 0.03442947417179583, 0.029129803065152796, 0.02389985699150888, 0.01928526180293792, 0.015277207320811472, 0.01199226825584506, 0.0088685593793952, 0.007885857916807308]
# our_w_filter = [0.8423603780907497, 0.8098433763792181, 0.7814873046320406, 0.7601793673393129, 0.7441570466748416, 0.7306070584954268, 0.7128028621947003, 0.7028016117445327, 0.6901559516437947, 0.6784884697677731, 0.6706463010815228, 0.659115784402885, 0.6499980912122922, 0.6404848321118727, 0.6336616615261609, 0.6197306574960041, 0.6121532737701799, 0.6037782825973252, 0.5964761368285824, 0.5891251371497513, 0.5830054790998301, 0.57183005211431, 0.5640921419095548, 0.5542909409087137, 0.5476788977494429, 0.5416139547553704, 0.5313293453009553, 0.5247968806209713, 0.5173691020586896, 0.5098550922969798, 0.5039408424406447, 0.4960286063413101, 0.48930908532693146, 0.4828502219671794, 0.47453468726373177, 0.46704906412989394, 0.4587899636531515, 0.45149250733821406, 0.44468450579467883, 0.4369386961602625, 0.4306042768969854, 0.4225228773019206, 0.41518080635808446, 0.4074395970297726, 0.40022702426653134, 0.3919284891447693, 0.38443507756727574, 0.3778995690235471, 0.3712906797738732, 0.36436797871762894, 0.3584553776875303, 0.339745575532178, 0.3332547961164555, 0.32586376283863216, 0.3184192619963938, 0.31127020036276465, 0.30332764838821696, 0.29579934108318545, 0.28922202851984274, 0.2820380128916858, 0.27637389049133826, 0.26696635291351606, 0.2583941793067992, 0.2508970282456566, 0.24254761297566635, 0.23363831980970431, 0.22594431426857017, 0.21489835027634563, 0.2071994913446618, 0.20050602255634103, 0.19243494043943532, 0.18595478935142817, 0.1783122800165089, 0.1694672214620092, 0.16275039043944786, 0.156206424799089, 0.14800741205581394, 0.1393148997063672, 0.13064376285194335, 0.12359222607104912, 0.11757603211445804, 0.11032990330745734, 0.1025603459170617, 0.09528681103160594, 0.08742243012758243, 0.08071451992020742, 0.07449441544652462, 0.06812055366828486, 0.06105098361689656, 0.05259142878396902, 0.04740708054019069, 0.04151838690801501, 0.03734593439549455, 0.03210182660705556, 0.026680115306452087, 0.02285066791433437, 0.018012634706536173, 0.01472272781422524, 0.011719861149030775, 0.009582471025784847, 0.008930306494362788]

# baseline_wo_filter_50 = [0.9637006991959822, 0.9605459372912204, 0.9523309106314949, 0.9491785366616173, 0.9434435794616558, 0.9390768206598415, 0.9242022495948289, 0.9199324262188028, 0.9122928720250987, 0.9055776738610675, 0.8990408714436557, 0.8880332374423119, 0.8782146719443311, 0.868157921300159, 0.8644151000140998, 0.8546759003392042, 0.8463003257310837, 0.8409338668144294, 0.8338212122576942, 0.8274489379775237, 0.8233050043634079, 0.8117050234999316, 0.8073491344872887, 0.8002793631248453, 0.793390008897525, 0.7884999636207737, 0.7785842386220111, 0.7732972197984868, 0.7648206365437716, 0.7553709112570774, 0.7505574438738475, 0.7416699409056123, 0.7350045037903433, 0.7295960286262463, 0.7212520989210778, 0.7146625249935181, 0.7055908526389746, 0.6984612120295842, 0.6907890866274206, 0.6831117225196094, 0.6769689050498905, 0.6647100767932157, 0.6580864787059283, 0.6490650749262827, 0.6404825172574254, 0.6313135297335722, 0.6257035816576058, 0.6164398360021998, 0.6084472450121479, 0.6020770926926843, 0.5959422037705472, 0.5710053490756196, 0.5638763001487557, 0.553395525304417, 0.5453737576302063, 0.5370789190683323, 0.5261663754941858, 0.5179335566747839, 0.5104225999186282, 0.5013411262727189, 0.49247937564868405, 0.4761344046327104, 0.46360841305096745, 0.4548006580771641, 0.4466368123831795, 0.4350017768971929, 0.42416084079773864, 0.40816714504385915, 0.399370641890233, 0.3905849519970998, 0.3814881160511339, 0.372070772690174, 0.36087505125951447, 0.3485368580657169, 0.3386982188590632, 0.32598963466684805, 0.3133590679696105, 0.30263596102564083, 0.28731834011826507, 0.2751006672030247, 0.262622521870423, 0.2488474712304129, 0.2382421137533758, 0.2253697172524225, 0.21110959276047017, 0.19971570548668607, 0.18744794211278515, 0.1737384394379136, 0.16316370071012504, 0.14840046655069436, 0.13719890268588902, 0.1212175200421895, 0.11012638654831543, 0.093339259097791, 0.08203304764774044, 0.06949045802401153, 0.0572340966406198, 0.04431509336604941, 0.03245875180300268, 0.02118677143419087, 0.016092053399801243]
# our_wo_filter_50 = [0.9622871197089948, 0.9555387220690529, 0.9463540968814854, 0.9415587832421201, 0.9344035711909869, 0.9278316311639961, 0.91929364224692, 0.9126023586463058, 0.9056465525254, 0.8971899341460059, 0.8933930712946735, 0.8826325897790004, 0.8750421449776044, 0.8699938390134074, 0.8656457635142794, 0.8520591717998396, 0.8451611783793772, 0.8361656199438343, 0.8295027650524144, 0.8233221583691503, 0.8190793912988021, 0.8073953093184226, 0.8003117210390253, 0.791611574923581, 0.7857869635387029, 0.7808977798700621, 0.7696659183551178, 0.7633205356288929, 0.7557268973739302, 0.747247984901286, 0.7422284607059735, 0.7354319870629527, 0.7291504992899651, 0.7250754746442512, 0.7186058502735797, 0.7108140852353332, 0.7019076248995423, 0.6943562364342816, 0.6878353400814581, 0.6788540972303703, 0.6722576501840197, 0.6632131202763202, 0.6555781168906007, 0.6477993972422286, 0.6410036030524957, 0.6318330146767682, 0.6226450588691299, 0.6163247059538774, 0.6091460827894233, 0.602203474912608, 0.5957263187987216, 0.5699295013150302, 0.5626764087242144, 0.5531110703320125, 0.5430833699390241, 0.5342426598649297, 0.5253221122240475, 0.5179610585712866, 0.5080723912858881, 0.5000938558499125, 0.49332255280580994, 0.4813932454529384, 0.4712620484949843, 0.4647267163841955, 0.4547409697808493, 0.4418021461411485, 0.43136931597623174, 0.41796848880561804, 0.4089112470654048, 0.3991284635939944, 0.389673415146528, 0.3805949555721119, 0.3697358239856444, 0.35621164345885675, 0.34575549567246067, 0.33495604743619994, 0.3238237404471125, 0.30839370371856567, 0.29746156879459285, 0.28679772851759655, 0.2757827585525546, 0.26113362098231163, 0.24576499543436794, 0.23390757591150133, 0.21747341737898987, 0.20229173819394256, 0.18909088323700907, 0.17779790848035962, 0.16361491521994656, 0.14198523799252943, 0.1265050192421662, 0.1135801343021143, 0.10365996706699132, 0.0903112243067139, 0.07714857158060667, 0.06554019531544752, 0.05487495755353812, 0.04199462583739008, 0.029759125614939055, 0.021692444218594453, 0.018439659694229348]
# baseline_w_filter_50 = [0.9663884787196992, 0.9658012646674116, 0.9612926854960089, 0.9578616113618098, 0.9540438186440832, 0.9524672501925965, 0.9424228245277345, 0.9385090916653527, 0.9329888612429644, 0.9262653538489113, 0.9215138509638015, 0.911419594820344, 0.9029048184039828, 0.8937140545567716, 0.8911746019319418, 0.8817716681877631, 0.8739852353566492, 0.8689746990315574, 0.8633953713470187, 0.8583732046360378, 0.854838903794664, 0.8450675586962162, 0.8409712321776609, 0.83470060862019, 0.8285770597778845, 0.8245015041617193, 0.815019940883977, 0.8101159948746302, 0.8024465058280414, 0.79403096349977, 0.7894180591134817, 0.7815078888828578, 0.774977417972385, 0.7700705068110975, 0.7629018553000372, 0.7567527629009791, 0.7480413837121325, 0.741052142737191, 0.7337291394076616, 0.7257841036688696, 0.7197456911843658, 0.7078361646786665, 0.7014152076174024, 0.6930334075687234, 0.6844448459247928, 0.6748177192369399, 0.6692988763457194, 0.6602612158947516, 0.6521825040122916, 0.6456806217220953, 0.6392212792182693, 0.6145957045224132, 0.6072359642301642, 0.5965327945572442, 0.5873681070046168, 0.5782101066347578, 0.5669765784262096, 0.5581702308122132, 0.5503285853698701, 0.5407555956285592, 0.5313607734281264, 0.5147021100487438, 0.501662154418804, 0.49252706488774617, 0.4839290992852413, 0.47179794861850805, 0.46020193048100805, 0.4438417582285157, 0.43450909329172516, 0.42532516435029993, 0.415610286467435, 0.40535675357189693, 0.3939253469378333, 0.38042457192808, 0.3694518099579135, 0.35566770979206463, 0.3424306436986153, 0.33065094158356967, 0.3143593864956808, 0.3016236109963144, 0.2881596781221067, 0.2733942330904292, 0.262058587228469, 0.24790728247963173, 0.23272202500047307, 0.22003947724357462, 0.20754566353285447, 0.1923144257399888, 0.18112552716822394, 0.1658531793094219, 0.1536892493979986, 0.13771398184104816, 0.1258934589036232, 0.10787787106992258, 0.09554773742706678, 0.08215298227182181, 0.06789611293261216, 0.05332615660738398, 0.03909998527013352, 0.024558778283165755, 0.016832281136112]
# our_w_filter_50 = [0.9658916170634922, 0.9612420002723311, 0.952670873711817, 0.9500233666355276, 0.9464389489891922, 0.9415258657417448, 0.9346431450514048, 0.9299680740678894, 0.9232747155219307, 0.9173950477824988, 0.9144026358050156, 0.9048900317066667, 0.8986995438461878, 0.8933890487349225, 0.8894939277071183, 0.8763148231584043, 0.8710826432898586, 0.8642800111310753, 0.8594190298552764, 0.8547081414625044, 0.8510515445475543, 0.8404427476575651, 0.8343022939308514, 0.8266045645531684, 0.8217823615254027, 0.8172639122857954, 0.8074446789789334, 0.8020149587657475, 0.7963298887184289, 0.7887026821073368, 0.78357049952377, 0.7777096370065884, 0.7714188523505895, 0.7676022050724752, 0.7622167460463191, 0.7553076156784143, 0.7469484748954492, 0.739358043278038, 0.7329149718520624, 0.7246743701357343, 0.7183750447603008, 0.7096927035500049, 0.7022377605306444, 0.6948506423956013, 0.6885278311435218, 0.678445984629175, 0.6695216335748687, 0.6635739668059073, 0.6559350981354637, 0.6489569511090636, 0.6426190653667978, 0.6154420025244016, 0.6086654447951332, 0.5992662551770869, 0.5896130470769028, 0.5807504384387889, 0.5711438561932556, 0.563528303846051, 0.5535772389285015, 0.5454348847363162, 0.5382624262881907, 0.5263164071658358, 0.5152693775806644, 0.5081536516496908, 0.49709004174133525, 0.4836624322363805, 0.47285569558404855, 0.4586790462242802, 0.44895621486386944, 0.4389343918053221, 0.42890241559972664, 0.4191827623697086, 0.40758096702987273, 0.3932448390883432, 0.38224555171545493, 0.3703784423094547, 0.35855504031348784, 0.3420747604797024, 0.33087524057887685, 0.3194754460288358, 0.3077736776813806, 0.2924028371065173, 0.2756260942080198, 0.26268709216651565, 0.245176366294518, 0.22936703504282985, 0.2150105643789152, 0.20307505668572132, 0.18807138562059927, 0.16518956884038122, 0.14922404405390666, 0.13510295990283358, 0.12475148969239964, 0.10968708825927262, 0.09387261886659995, 0.08055724142958495, 0.06786434140334979, 0.052032952665370696, 0.03790650894296583, 0.026244574198830722, 0.01972292888461015]

all_80 = [0.9684678358927745, 0.9603092376272203, 0.9534386227733209, 0.949956555417286, 0.9473647026267974, 0.939553384030407, 0.9306626164775891, 0.9286761703792558, 0.9243772360609499, 0.9184590416983869, 0.9130975953735696, 0.9078970080169219, 0.9042164805773424, 0.8999193478387306, 0.8954055663200919, 0.8884435186052164, 0.8827338874430763, 0.8758810202563898, 0.8703703356808701, 0.8664321983810709, 0.8618686029655133, 0.8507704114868214, 0.8412517306144708, 0.8351627006677871, 0.8290612812101733, 0.82204626025223, 0.8055660657496195, 0.8010519398576705, 0.7942797210711264, 0.787399277284172, 0.781235335480718, 0.7746207649659931, 0.7682119513621383, 0.7613539662015806, 0.7526062536165532, 0.7477228093080102, 0.7403420701366233, 0.7326486547857534, 0.7273146549393822, 0.7197057983767967, 0.7147881949589764, 0.702524408126052, 0.6954361319311073, 0.686725205962568, 0.6804229451265827, 0.672545309262746, 0.6668897919756623, 0.6557645307044172, 0.6482817939143433, 0.640403219930749, 0.6336504849620002, 0.6098809996421826, 0.6027345074382517, 0.5933059276084267, 0.5861841588189631, 0.5783061570668395, 0.565669103754784, 0.557875352847866, 0.548468513041854, 0.5385711932487083, 0.5318358818231587, 0.5203757960171589, 0.5109939864653505, 0.5011593532971848, 0.4907553308128999, 0.47829619762955805, 0.46695406386290245, 0.4505609685268769, 0.4401066147796509, 0.4298887888499775, 0.4199304692727563, 0.40857632996502025, 0.3973653068745547, 0.38255044415497047, 0.3717083724971555, 0.36175060157163963, 0.34841736700525927, 0.3361982077671574, 0.318720806760328, 0.3047535229063965, 0.29306071285494, 0.2793210158710997, 0.26616171716778253, 0.2492805652023298, 0.2355040514170346, 0.21939494367029214, 0.20817313459685213, 0.19435558237569628, 0.18011310677582337, 0.16178722300998669, 0.15011729643740193, 0.1308093424480548, 0.11706873222839291, 0.09790169858950064, 0.08656010954153835, 0.07200484255873603, 0.06397042873397346, 0.05109448247876853, 0.038036032783478106, 0.026075890033270214, 0.019243716494133065]
base48 = [0.9725150200715361, 0.9697505114861289, 0.9635291946781107, 0.9581229172018012, 0.9547308882120333, 0.948396144775169, 0.937755754676513, 0.9342327233068196, 0.9296102588839419, 0.922868046337972, 0.917206309026662, 0.9086306796944145, 0.9005676326747469, 0.8906116857934226, 0.8869812314756014, 0.8744889297811768, 0.8692737148762651, 0.8656995205430817, 0.8582438419075387, 0.8527350764458039, 0.8477068918284517, 0.832684404819727, 0.8257925350506606, 0.8178301481364278, 0.8103569153239226, 0.8056384758725545, 0.7914587519214483, 0.7864645439365531, 0.7815017752334078, 0.7743201201647718, 0.769270792639959, 0.7614951026959041, 0.7551082785526194, 0.7491144570780384, 0.7412020242761312, 0.7360133959482161, 0.7311155362335182, 0.7209047901559564, 0.7146568664074758, 0.7069483584994851, 0.701969981389852, 0.692578330304685, 0.6858930714747344, 0.6740581261458964, 0.6675405573245804, 0.6601739384541538, 0.652979221669075, 0.6463432093460524, 0.6393732542727224, 0.63206575935438, 0.6250868873707515, 0.6016368162963821, 0.5950171977398239, 0.5862759025718547, 0.5764439907624542, 0.5684799666559806, 0.5582450505661948, 0.5492207941973216, 0.5387376760679946, 0.5302360473720259, 0.5237349604364178, 0.51126539909215, 0.5021087014178157, 0.493963866684072, 0.48266549595420805, 0.47242909088454876, 0.4626574067028404, 0.4488047484670435, 0.4383825441815611, 0.42844765903527154, 0.4136730596552354, 0.40457747155755863, 0.3934313577459821, 0.3785208153435044, 0.3654904365031638, 0.35469958403501617, 0.3407017293748031, 0.3290238924053429, 0.3123521602061211, 0.2985484170528025, 0.28833999286933487, 0.27552403191566843, 0.2637369006120257, 0.2506664713781435, 0.23585304030346674, 0.2210173087439047, 0.2059933101462773, 0.19062220802032445, 0.17594998176668167, 0.16026655838286405, 0.14819117063965573, 0.1331187013213795, 0.12177651321543435, 0.1037816956889001, 0.09088988147889848, 0.07869409001044214, 0.0659971627334818, 0.053041234025214636, 0.03946078775351668, 0.027916239138651197, 0.02185644108222626]




# plt.plot(x, baseline_wo_filter , color='red', label='baseline_wo_filter')
# plt.plot(x, our_wo_filter , color='green', label='our_wo_filter')
# plt.plot(x, baseline_w_filter , color='blue', label='baseline_w_filter')
# plt.plot(x, our_w_filter , color='olive', label='our_w_filter')

# plt.plot(x, baseline_wo_filter_50 , color='red', label='baseline_wo_filter_50')
# plt.plot(x, our_wo_filter_50 , color='green', label='our_wo_filter_50')
# plt.plot(x, baseline_w_filter_50 , color='blue', label='baseline_w_filter_50')
# plt.plot(x, our_w_filter_50 , color='olive', label='our_w_filter_50')

plt.plot(x, base48 , color='red', label='trained base48 evaluated on base48')
plt.plot(x, all_80 , color='green', label='trained all80 evaluated on base48')

# for filter fp
# plt.plot(x, base_y , color='red', label='base_50')
# plt.plot(x, novel_y , color='green', label='novel_50')
# plt.plot(x, optimal_result_y , color='blue', label='optimal result')
#plt.plot(x, fixed_novel_y , color='black', label='label fixed novel_50')
#plt.plot(x, filter_fp_novel_y , color='olive', label='filter fp novel_50')
#plt.plot(x, filter_fp_base_y , color='pink', label='filter fp base_50')

# plt.plot(x, add_fn_novel_y , color='olive', label='add fn novel_50')
# plt.plot(x, add_fn_base_y , color='pink', label='add fn base_50')

font1 = {'size': 10}
plt.legend(loc=4, prop=font1) # 
plt.grid()
plt.xlabel('recall', fontsize=13)
plt.ylabel('precision', fontsize=13)
#plt.ylabel('mAP(%)', fontsize=13)
plt.show()